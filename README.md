# SIEM Deployment & Threat Monitoring Using Splunk

## Project Overview:
This project focuses on deploying **Splunk** in a home lab environment to monitor multiple data sources, set up custom dashboards, and create alerts for threat detection. The project also includes responding to simulated incidents to enhance log analysis and threat-hunting skills.

### Key Achievements:
- Deployed **Splunk** and monitored 5+ data sources.
- Detected and responded to 15+ simulated incidents.
- Improved skills in log analysis and threat detection using Splunk.

---

## Steps Involved

### Step 1: Set Up a Virtual Lab Environment

#### Tools Used:
- **VirtualBox** for virtual machines.
- **Windows Server** and **Linux VMs** (for generating logs).
- **Splunk Free Edition** (for SIEM setup).

#### Steps 
1. Installed **VirtualBox** create virtual machines (VMs) for Windows and Linux.
2. Ensured network connectivity between the VMs.
3. Assigned static IP addresses.

---

### Step 2: Installed Splunk in the Home Lab

#### Downloaded & Installed Splunk:
- Download **Splunk Enterprise** (Free Trial or Free Version) from the [Splunk website](https://www.splunk.com/).
- Installed Splunk on my loval machine.
- Set up a default admin username and password during installation.

#### Splunk Configuration:
1. Loged in to the Splunk web interface via `http://localhost:8000.
2. Start Splunk as a service using:

---

### Step 3: Integrate Data Sources

#### Data Sources to Monitor:
- **Windows Event Logs** (using Splunk Universal Forwarder).
- **Linux System Logs** (using syslog or Splunk Forwarder).
- **Firewall Logs** (from pfSense or any other firewall).
- **Web Server Logs** (from Apache or Nginx).

#### Steps to Integrate:
1. **Windows Logs**: Installed the Splunk Universal Forwarder on the Windows VM. Configure it to send **Windows Event Logs** (Security, Application, System) to Splunk.
   
2. **Linux Logs**: installed the **Splunk Universal Forwarder** to send `/var/log/syslog` or `/var/log/auth.log` to Splunk.

3. **Firewall Logs**: Configured **pfSense** or another firewall to forward logs to the Splunk VM.

4. **Web Server Logs**: Installed **Apache** or **Nginx** and forward access/error logs to Splunk.

5. **Router Logs**: Configured your router to send logs via syslog to the Splunk instance.

---

### Step 4: Created Custom Dashboards & Alerts

#### Created Dashboards:
1. Navigate to the Splunk Web UI > **Search & Reporting**.
2. Query each data source using Splunk’s **Search Processing Language (SPL)**.
   
3. Save search queries as visualizations and create custom dashboards to monitor log volume, failed logins, and suspicious behavior.

#### Set Up Alerts:
- defined rules for specific patterns by going to **Settings > Alerts**.
-  Created Alert Rules Such as :
  - **Failed Logins**: Detect multiple failed login attempts.
  - **Privilege Escalation**: Alert for changes in user privileges or group memberships.
  - **Suspicious Traffic**: Monitor traffic to/from unusual IP addresses.

---

### Step 5: Simulate Incidents for Threat Detection

#### Simulate Attacks:
- Used tools like **Metasploit** or **Kali Linux** to simulate attacks (e.g., brute force, privilege escalation, port scanning).
- Simulate phishing attempts, malware execution using **Malware Traffic Analysis** data.

#### Detect & Respond:
- Investigated logs, generated by simulations in Splunk.
- Used alerts to catch abnormal behavior (e.g., brute force detection).
- Took appropriate action to contain and analyze incidents.

---

### Step 6: Log Analysis & Incident Response

#### Analyze Logs:
- Searched logs for patterns (e.g., multiple failed logins, traffic from blacklisted IPs, privilege changes).
- Useed Splunk’s timeline and log comparison features to narrow down the incident timeline.

#### Respond to Incidents:
- Created a documented process for incident response (containment, eradication, recovery).
- Investigated and closed each incident by reviewing related logs and identifying the root cause.

---

### Step 7: Ongoing Monitoring & Improvements

- **Fine-tune Alerts**: Adjust thresholds and filters to reduce false positives and improve alert accuracy.
- **Dashboard Optimization**: Continuously update dashboards with relevant metrics as you identify key security indicators.

---


## Conclusion

By following these steps, you can deploy Splunk in a home lab environment, integrate various data sources, set up custom dashboards, and respond to simulated cybersecurity threats. This project provides hands-on experience with SIEM tools, log analysis, and incident response, essential for a career in cybersecurity.
